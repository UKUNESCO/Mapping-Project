<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Select features around a clicked point</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
<script src="https://api.mapbox.com/mapbox-gl-js/v1.9.0/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v1.9.0/mapbox-gl.css" rel="stylesheet" />
<script src='https://unpkg.com/@turf/turf/turf.js'></script>
<style>
	body { margin: 0; padding: 0; }
	#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>
<body>
<div id="map"></div>

<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoibWlrZWxtYXJvbiIsImEiOiJjaWZlY25lZGQ2cTJjc2trbmdiZDdjYjllIn0.Wx1n0X7aeCQyDTnK6_mrGw';
    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v11',
        center: [29.39893,-3.36987],
        minZoom: 2,
        zoom: 16
    });

    map.on('load', function() {

        map.on('click', function(e) {
          var bbox = [
            map.project(turf.destination([e.lngLat.lng, e.lngLat.lat], .15, -45).geometry.coordinates),
            map.project(turf.destination([e.lngLat.lng, e.lngLat.lat], .15, 135).geometry.coordinates)
          ];

          var features = map.queryRenderedFeatures(bbox, {
            layers: ['road-motorway-trunk','road-primary','road-secondary-tertiary','road-street', 'road-major-link', 'road-path', 'road-construction', 'bridge-primary-secondary-tertiary']
          });

          if (map.getSource('nearby-roads')) {
            map.removeLayer('nearby-roads-lines');
            map.removeSource('nearby-roads');
          }

          map.addSource('nearby-roads', {
            'type': 'geojson',
            'data': {
              'type': 'FeatureCollection',
              'features': features
            }
          });
          map.addLayer({
            'id': 'nearby-roads-lines',
            'type': 'line',
            'source': 'nearby-roads',
            'paint': {
              'line-color': '#FF0000',
              'line-width': 5,
              'line-opacity': .25
            },
            'layout': {
              'line-cap': 'round'
            }
          });
        });
    });
</script>

</body>
</html>
